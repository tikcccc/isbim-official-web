<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Chapter 2: Operational Intelligence</title>
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- React & ReactDOM -->
    <script crossorigin src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    
    <!-- Framer Motion -->
    <script src="https://unpkg.com/framer-motion@10.16.4/dist/framer-motion.js"></script>
    
    <!-- Lenis -->
    <script src="https://unpkg.com/lenis@1.1.18/dist/lenis.min.js"></script>

    <style>
        body {
            background-color: #0a0a0a;
            color: white;
            overflow-x: hidden;
        }
        /* Hide Scrollbar */
        ::-webkit-scrollbar {
            width: 0px;
            background: transparent;
        }
    </style>
</head>
<body>
    <div id="root"></div>

    <script>
        const { useState, useEffect, useRef } = React;
        const { motion, useScroll, useTransform, AnimatePresence } = window.Motion;

        // --- Icons (Inline SVG components to avoid external dependencies) ---
        const MenuIcon = ({ className }) => React.createElement('svg', { className, xmlns: "http://www.w3.org/2000/svg", width: "24", height: "24", viewBox: "0 0 24 24", fill: "none", stroke: "currentColor", strokeWidth: "2", strokeLinecap: "round", strokeLinejoin: "round" }, React.createElement('line', { x1: "4", x2: "20", y1: "12", y2: "12" }), React.createElement('line', { x1: "4", x2: "20", y1: "6", y2: "6" }), React.createElement('line', { x1: "4", x2: "20", y1: "18", y2: "18" }));
        const ShieldAlertIcon = ({ className }) => React.createElement('svg', { className, xmlns: "http://www.w3.org/2000/svg", width: "24", height: "24", viewBox: "0 0 24 24", fill: "none", stroke: "currentColor", strokeWidth: "2", strokeLinecap: "round", strokeLinejoin: "round" }, React.createElement('path', { d: "M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10" }), React.createElement('path', { d: "M12 8v4" }), React.createElement('path', { d: "M12 16h.01" }));
        const SearchIcon = ({ className }) => React.createElement('svg', { className, xmlns: "http://www.w3.org/2000/svg", width: "24", height: "24", viewBox: "0 0 24 24", fill: "none", stroke: "currentColor", strokeWidth: "2", strokeLinecap: "round", strokeLinejoin: "round" }, React.createElement('circle', { cx: "11", cy: "11", r: "8" }), React.createElement('path', { d: "m21 21-4.3-4.3" }));
        const ActivityIcon = ({ className }) => React.createElement('svg', { className, xmlns: "http://www.w3.org/2000/svg", width: "24", height: "24", viewBox: "0 0 24 24", fill: "none", stroke: "currentColor", strokeWidth: "2", strokeLinecap: "round", strokeLinejoin: "round" }, React.createElement('path', { d: "M22 12h-4l-3 9L9 3l-3 9H2" }));
        const GlobeIcon = ({ className }) => React.createElement('svg', { className, xmlns: "http://www.w3.org/2000/svg", width: "24", height: "24", viewBox: "0 0 24 24", fill: "none", stroke: "currentColor", strokeWidth: "2", strokeLinecap: "round", strokeLinejoin: "round" }, React.createElement('circle', { cx: "12", cy: "12", r: "10" }), React.createElement('path', { d: "M12 2a14.5 14.5 0 0 0 0 20 14.5 14.5 0 0 0 0-20" }), React.createElement('path', { d: "M2 12h20" }));
        const ZapIcon = ({ className }) => React.createElement('svg', { className, xmlns: "http://www.w3.org/2000/svg", width: "24", height: "24", viewBox: "0 0 24 24", fill: "none", stroke: "currentColor", strokeWidth: "2", strokeLinecap: "round", strokeLinejoin: "round" }, React.createElement('path', { d: "M4 14a1 1 0 0 1-.78-1.63l9.9-10.2a.5.5 0 0 1 .86.46l-1.92 6.02A1 1 0 0 0 13 10h7a1 1 0 0 1 .78 1.63l-9.9 10.2a.5.5 0 0 1-.86-.46l1.92-6.02A1 1 0 0 0 11 14H4z" }));

        // --- Video Dashboard Component ---
        const VideoDashboard = ({ highlightStep }) => {
            const activeVideo = highlightStep >= 4 ? 2 : 1;

            const spotlightConfig = {
                0: { opacity: 0, t: '50%', l: '50%', w: '0%', h: '0%', text: "", labelPos: 'bottom' },
                
                // Video 1: Cyber Defense
                1: { opacity: 1, t: '20%', l: '10%', w: '25%', h: '30%', text: "AI Sentinel: 偵測到異常流量", labelPos: 'right' },
                2: { opacity: 1, t: '55%', l: '55%', w: '30%', h: '25%', text: "Deep Scan: 來源日誌分析中", labelPos: 'left' },
                3: { opacity: 1, t: '30%', l: '35%', w: '30%', h: '40%', text: "Threat Lock: 核心威脅已鎖定", labelPos: 'right' },

                // Video 2: Global Supply
                4: { opacity: 1, t: '15%', l: '55%', w: '35%', h: '40%', text: "Global View: 評估節點影響範圍", labelPos: 'left' },
                5: { opacity: 1, t: '60%', l: '10%', w: '40%', h: '25%', text: "Route Opt: 計算最優替代路徑", labelPos: 'top' },
                6: { opacity: 1, t: '40%', l: '40%', w: '20%', h: '20%', text: "Auto Execute: 授權 AI 自動修復", labelPos: 'bottom' },
            };

            const currentSpot = spotlightConfig[highlightStep] || spotlightConfig[0];

            const getLabelStyle = () => {
                const { t, l, w, h, labelPos } = currentSpot;
                const gap = "24px";
                
                const style = {};
                
                // Basic positioning logic
                if (labelPos === 'right') {
                    style.top = t;
                    style.left = `calc(${l} + ${w} + ${gap})`;
                } else if (labelPos === 'left') {
                    style.top = t;
                    style.right = `calc(100% - ${l} + ${gap})`;
                    style.textAlign = 'right';
                } else if (labelPos === 'top') {
                    style.bottom = `calc(100% - ${t} + ${gap})`;
                    style.left = l;
                } else if (labelPos === 'bottom') {
                    style.top = `calc(${t} + ${h} + ${gap})`;
                    style.left = l;
                }
                return style;
            };

            const labelStyle = getLabelStyle();

            return React.createElement('div', { className: "relative w-full max-w-6xl aspect-video bg-slate-900 rounded-xl border border-slate-800 shadow-2xl overflow-hidden flex flex-col group" },
                // Header
                React.createElement('div', { className: "absolute top-0 left-0 right-0 h-12 border-b border-white/10 flex items-center px-4 justify-between bg-black/60 backdrop-blur-sm z-30 transition-colors duration-500" },
                    React.createElement('div', { className: "flex items-center gap-4" },
                        React.createElement(MenuIcon, { className: "w-5 h-5 text-white/70" }),
                        React.createElement(AnimatePresence, { mode: 'wait' },
                            React.createElement(motion.span, {
                                key: activeVideo,
                                initial: { opacity: 0, y: 10 },
                                animate: { opacity: 1, y: 0 },
                                exit: { opacity: 0, y: -10 },
                                className: "font-mono text-sm text-blue-400 font-bold"
                            }, activeVideo === 1 ? "VIBE_OS // CYBER_DEFENSE" : "VIBE_OS // GLOBAL_SUPPLY")
                        )
                    ),
                    React.createElement('div', { className: "flex items-center gap-4" },
                        React.createElement('div', { className: "flex items-center gap-2" },
                            React.createElement('div', { className: `w-2 h-2 rounded-full animate-pulse ${activeVideo === 1 ? 'bg-red-500' : 'bg-green-500'}` }),
                            React.createElement('span', { className: "text-xs text-white/70 font-mono" }, "LIVE FEED")
                        )
                    )
                ),

                // Video Engine
                React.createElement('div', { className: "relative flex-1 w-full h-full bg-black" },
                    // Video 1
                    React.createElement(motion.div, {
                        className: "absolute inset-0 w-full h-full",
                        animate: { opacity: activeVideo === 1 ? 1 : 0 },
                        transition: { duration: 1 }
                    },
                        React.createElement('video', {
                            className: "w-full h-full object-cover",
                            autoPlay: true, loop: true, muted: true, playsInline: true,
                            src: "https://cdn.coverr.co/videos/coverr-cyber-attack-simulation-screen-5694/1080p.mp4"
                        }),
                        React.createElement('div', { className: "absolute inset-0 bg-blue-900/10 mix-blend-overlay" })
                    ),
                    // Video 2
                    React.createElement(motion.div, {
                        className: "absolute inset-0 w-full h-full",
                        animate: { opacity: activeVideo === 2 ? 1 : 0 },
                        transition: { duration: 1 }
                    },
                        React.createElement('video', {
                            className: "w-full h-full object-cover",
                            autoPlay: true, loop: true, muted: true, playsInline: true,
                            src: "https://cdn.coverr.co/videos/coverr-digital-world-map-animation-5537/1080p.mp4"
                        }),
                        React.createElement('div', { className: "absolute inset-0 bg-emerald-900/10 mix-blend-overlay" })
                    )
                ),

                // Spotlight Box
                React.createElement(motion.div, {
                    className: "absolute z-20 pointer-events-none border border-blue-400/80 rounded-lg shadow-[0_0_30px_rgba(59,130,246,0.4)]",
                    initial: false,
                    animate: {
                        top: currentSpot.t,
                        left: currentSpot.l,
                        width: currentSpot.w,
                        height: currentSpot.h,
                        opacity: currentSpot.opacity,
                        boxShadow: `0 0 0 9999px rgba(0, 0, 0, 0.75)`
                    },
                    transition: { duration: 0.6, ease: "circOut" }
                }),

                // Dynamic Label
                React.createElement(AnimatePresence, { mode: 'wait' },
                    highlightStep > 0 && React.createElement(motion.div, {
                        key: highlightStep,
                        className: "absolute z-30 pointer-events-none",
                        style: labelStyle,
                        initial: { opacity: 0, scale: 0.9 },
                        animate: { opacity: 1, scale: 1 },
                        exit: { opacity: 0, scale: 0.9 },
                        transition: { duration: 0.3, delay: 0.1 }
                    },
                        React.createElement('div', { 
                            className: `flex items-center gap-3 bg-slate-900/90 backdrop-blur-md border border-blue-500/30 p-4 rounded-lg shadow-xl max-w-xs ${currentSpot.labelPos === 'left' ? 'flex-row-reverse' : ''}` 
                        },
                            React.createElement('div', { className: "w-1 h-8 bg-blue-500 rounded-full shrink-0" }),
                            React.createElement('div', { className: `text-left ${currentSpot.labelPos === 'left' ? 'text-right' : ''}` },
                                React.createElement('p', { className: "text-blue-200 font-mono text-xs uppercase tracking-wider mb-1" }, "System Insight"),
                                React.createElement('p', { className: "text-white text-sm font-medium leading-relaxed whitespace-nowrap md:whitespace-normal" }, currentSpot.text)
                            )
                        )
                    )
                ),
                
                // Scanlines
                React.createElement('div', { className: "absolute inset-0 pointer-events-none z-20 bg-[linear-gradient(rgba(18,16,16,0)_50%,rgba(0,0,0,0.25)_50%)] bg-[length:100%_4px] opacity-10" })
            );
        };

        // --- Main App Component ---
        const App = () => {
            const containerRef = useRef(null);

            // Init Lenis
            useEffect(() => {
                const lenis = new Lenis({
                    duration: 1.2,
                    easing: (t) => Math.min(1, 1.001 - Math.pow(2, -10 * t)),
                    direction: 'vertical',
                    gestureDirection: 'vertical',
                    smooth: true,
                    smoothTouch: false,
                });

                function raf(time) {
                    lenis.raf(time);
                    requestAnimationFrame(raf);
                }
                requestAnimationFrame(raf);

                return () => lenis.destroy();
            }, []);

            const { scrollYProgress } = useScroll({
                target: containerRef,
                offset: ["start start", "end end"]
            });

            const [highlightStep, setHighlightStep] = useState(0);

            useEffect(() => {
                return scrollYProgress.on("change", (latest) => {
                    if (latest < 0.15) setHighlightStep(0);
                    else if (latest >= 0.15 && latest < 0.25) setHighlightStep(1);
                    else if (latest >= 0.25 && latest < 0.35) setHighlightStep(2);
                    else if (latest >= 0.35 && latest < 0.45) setHighlightStep(3);
                    else if (latest >= 0.45 && latest < 0.55) setHighlightStep(0); // Transition
                    else if (latest >= 0.55 && latest < 0.70) setHighlightStep(4);
                    else if (latest >= 0.70 && latest < 0.85) setHighlightStep(5);
                    else if (latest >= 0.85) setHighlightStep(6);
                });
            }, [scrollYProgress]);

            return React.createElement('div', { className: "bg-black min-h-screen font-sans selection:bg-blue-500/30" },
                
                // Chapter 2 Section (600vh tall track)
                React.createElement('div', { ref: containerRef, className: "relative z-20 bg-[#0a0a0a] h-[600vh]" },
                    // Sticky Stage (100vh)
                    React.createElement('div', { className: "sticky top-0 h-screen flex flex-col justify-center items-center overflow-hidden px-4 md:px-8" },
                        
                        // Header
                        React.createElement(motion.div, {
                            className: "absolute top-12 text-center z-30",
                            initial: { opacity: 0 },
                            whileInView: { opacity: 1 },
                            transition: { duration: 1 }
                        },
                            React.createElement('h3', { className: "text-blue-500 font-mono text-xs tracking-[0.3em] uppercase mb-2" }, "Chapter 02"),
                            React.createElement('h2', { className: "text-3xl md:text-5xl font-bold text-white tracking-tight" }, "Operational Intelligence")
                        ),

                        // Dashboard
                        React.createElement(VideoDashboard, { highlightStep: highlightStep }),

                        // Progress Sidebar
                        React.createElement('div', { className: "absolute right-8 top-1/2 -translate-y-1/2 flex flex-col gap-4 z-40" },
                            React.createElement('div', { className: `w-1 h-12 rounded-full transition-all duration-500 ${highlightStep >= 1 && highlightStep <= 3 ? 'bg-blue-500 scale-y-110' : 'bg-slate-800'}` }),
                            React.createElement('div', { className: "w-1 h-2 rounded-full bg-slate-900" }),
                            React.createElement('div', { className: `w-1 h-12 rounded-full transition-all duration-500 ${highlightStep >= 4 ? 'bg-emerald-500 scale-y-110' : 'bg-slate-800'}` })
                        )
                    )
                ),

                // Footer
                React.createElement('div', { className: "h-[50vh] bg-[#0a0a0a] flex items-center justify-center border-t border-slate-900" },
                    React.createElement('p', { className: "text-slate-600 font-mono text-sm" }, "END OF DEMO")
                )
            );
        };

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(React.createElement(App));
    </script>
</body>
</html>